LIBRARY ieee;
USE ieee.std_logic_1164.all;
USE ieee.std_logic_unsigned.all;

ENTITY MEMORIARAM16bits IS
 PORT(
 ADDRESS : IN STD_LOGIC_VECTOR (3 DOWNTO 0); --ENDEREÇO DE ENTRADA
 DATA : INOUT STD_LOGIC_VECTOR (3 DOWNTO 0); --DADOS ENTRADA E SAÍDA

 WR : IN STD_LOGIC; --ESCRITA SOMENTE
 RD : IN STD_LOGIC --LEITURA SOMENTE
 );

END ENTITY;
ARCHITECTURE COMPORTAMENTO OF MEMORIARAM16bits IS
 -----------VARIAVEIS INTERNAS--------------

 TYPE RAM IS ARRAY (INTEGER RANGE <>) OF STD_LOGIC_VECTOR (3 DOWNTO 0);
 CONSTANT RAM_DEPTH : INTEGER := 16;
 SIGNAL DATA_OUT : STD_LOGIC_VECTOR (3 DOWNTO 0);
 SIGNAL MEM : RAM (0 TO 15);

 -----------CÓDIGO--------------
BEGIN
 --TRI-STATE BUFFER CONTROL
 DATA <= DATA_OUT WHEN (RD = '1') ELSE (OTHERS => 'Z');

 --MEMORY WRITE BLOCK
 MEM_WRITE: PROCESS(ADDRESS, DATA, WR)
 BEGIN
 IF (WR = '1') THEN
 MEM(CONV_INTEGER(ADDRESS)) <= DATA;
 END IF;
 END PROCESS;

 --MEMORY READ BLOCK
 MEM_READ: PROCESS(ADDRESS, RD)
 BEGIN
 IF(RD = '1') THEN
 DATA_OUT <= MEM((CONV_INTEGER(ADDRESS)));
 END IF;
 END PROCESS;
END ARCHITECTURE;  
